LOCAL_BUILT_MODULE_SYM := $(LOCAL_BUILT_MODULE).sym
$(LOCAL_BUILT_MODULE_SYM): PRIVATE_DUMPSYMS := $(HOST_DUMPSYMS)
$(LOCAL_BUILT_MODULE_SYM): $(LOCAL_BUILT_MODULE)
	@ echo "Symbol file: $@"
	@ $(PRIVATE_DUMPSYMS) $< > $@ && \
	SYMB_CODE=`head -n1 $@ | cut -d" " -f4` && \
	SYMB_NAME=`head -n1 $@ | cut -d" " -f5` && \
	mkdir -p $(SYMBOLS_DIR)/$$SYMB_NAME/$$SYMB_CODE && \
	cp $@ $(SYMBOLS_DIR)/$$SYMB_NAME/$$SYMB_CODE

ifeq (true,$(EMULATOR_GENERATE_SYMBOLS))
$(if $(LOCAL_GENERATE_SYMBOLS), $(eval SYMBOLS+=$(LOCAL_BUILT_MODULE_SYM)))
endif
